# 区块链技术的效率以及未来


## 0. 缘起
  在一个夏日的下午，我（Tim）和Larry两人坐在咖啡馆里海阔天空的讨论区块链技术。我们发现讨论的焦点就在于区块链的效率。这种对于效率的考量，主要是与现有基于中心化云计算模式构建的标准互联网架构进行对比。进一步深入下去，我们觉得这是一种去伪存真的过程，会影响到未来区块链和数字资产技术应用落地的发展。

  与区块链行业火热不同的是，作为一个普通的用户，似乎除了比特币、以太坊钱包之外，依然用不到什么真正基于区块链的产品。为此，区块链为普通用户到底能带来什么？这是值得我们所有人去深刻反思的。也许，我们未必需要用传统互联网产品的高标准去要求这些分布式新技术。然而，面向未来可能出现的各种技术融合的可能，与传统方法和技术的对比，有利于我们梳理清楚这些新兴技术的性能特点与发展趋势。

## 1. 问题与挑战

### 1.1 区块链技术真的有效率吗？

  区块链是一种区别于传统集中化分布式计算构架的技术。该技术反其道而行之，采用了点对点的网络通讯模式，通过冗余的区块链数据存储模式和共识计算过程，去除了物理上的中心化。这种技术确实带来了焕然一新的网络结构模式，

  但是，另一方面，区块链的架构模式，让人们对其实际应用中的效率产生了疑问： 区块链的存储和计算，会有多个节点来做重复的存储和计算，会不会效率较低并且费用昂贵？与中心化的架构方案比较，特别是中心化分布式计算技术的比较，可以看到，去中心化千好万好，最不好的一点就是：不经济网络延时。目前，在以太坊及之后的一些区块链里，秒级成交已经成为了宣传点之一。为此我们就具体的情况从网络，账本存储，共识算法，智能合约等效率维度进行对比，提出挑战，引发思考，从而与业界同仁一起去追寻更好的答案。

  为了便于进行实际的横向对比，我们取2018年8月15日的主流区块链运行数据做一个比较。在下文中，我们选取了目前区块链中最主流的比特币（BTC）和以太坊（ETH），有较长历史的莱特币（LTC），以及新近得到普遍关注的加密币种达世币（DASH）等4个区块链公链项目，进行了专门的比较。

#### 1.1.1 典型区块链的计算效率

  2018年8月15日这一天，这四种公链基本的算力相关数据如下表所示。

|    公链    |     BTC     |    LTC    |   ETH      |  DASH        |
| --------- |:-----------:|:---------:|:----------:|:------------:|
|  全网算力   |  48.06 EH/s |  251 TH/s | 244 TH/s   |  1.538 PH/s  |
|  Hash算法  |  SHA-256    |  Scrypt   |  Ethash    |   X11        |
|  主流实现   |  ASIC       |   ASIC    |  GPU/ASIC  |  GPU/ASIC    |
|  出块间隔   |  606 s      |  152 s    |  14.5 s    |  156 s       |

  该表中，“H/s”表示每秒钟hash函数的计算次数，前缀“T”表示10的9次方（即10亿），“P”表示10的12次方（即1万亿），”E“表示10的15次方（即1千万亿）。所以，基本看到为了维持整个公链的共识计算效果，各个公链的计算都是非常惊人。

  然而，由于各种公链往往采用各自不同的共识计算方法，进而会采用不同的hash计算方法，表面上难以直接横向比较各个公链的计算效率。所以，有一个变通的方法是估算在同一类硬件中的执行效率，从而有直观的对比。例如，以ETH为例，我们可以假设全网采用了较为优化的AMD 580系列显卡。以此为基准，我们可以进行一个大概的估算。由各个数据来源报告所知，该显卡的实际计算能力为30 MH/s，即每秒钟计算“Ethash”的hash函数约3千万次，实际消耗功率为 0.135 KW/h（即用电单位"度"）。为此，简单可以估算出ETH全网约需要8,100,000张显卡。而主流的ETH矿机为8块显卡的配置，所以估计需要约 1,000,000台的以太坊显卡矿机。进一步估计出，ETH公链的小时耗电数为，1,093,500 KW/h，而每天（即24小时）需要耗电 26,244,000 KW/h，来维持全网的运行。大致按照每度电0.5元的费用核算，每天需要的电费成本估算为13,000,000元，即每天千万元的成本。而一整年更将耗资36亿元之巨。从中可以看出，区块链的公链这种互联网公共设施，消耗惊人。

  与此相关的是，矿工费太贵。如果你要让一笔以太坊交易成立，是需要花费一定的矿工费的。所谓矿工费，就是指交易发起者需要交纳一定的以太坊，用于奖励那些主动传播这笔交易的人。而如果你想要在以太坊上实现“秒级信息传递”，高额的矿工费自然是少不了的。

#### 1.1.2 网络传输的效率

目前，在以太坊及之后的一些区块链里，秒级成交已经成为了宣传点之一。但“能做到”和“做到要多少成本”不是一个概念。网络延时也是一个大问题，因为P2P网络不存在一个稳定的中转服务器，因此每次发送信息都是通过多个作为用户的节点中转送达，在信息传递上很难满足即时传输。但文章的同步速度是很慢。用户可能发布之后几个小时后，才能被人看到。文章还好，如果是要实现微博、微信这种需要高频信息发布和接收的dApp，就会出现一些问题。一个首要问题是：时间线错乱，或者说数据异步。一条微博下面的评论经常出现前后时间线错乱。这就是因为评论者发布的时间虽然早，但同步的时间慢，而后来者已经根据他之前的回复进一步展开了讨论导致的。



#### 1.1.3 外部存储的效率与冗余问题

在传统互联网模式下，比如 Google 要保障一个视频永久在线并被所有人都能看到，可能只需要留存一份视频（实际情况可能会有几份备份）。而对于区块链应用的用户来说，每个用户既是使用者，又是存储和带宽的贡献者。这意味着抬高了普通用户使用分布式应用的门槛。理论上，如果有一个精妙的算法，可以动态调节出全网的可靠存储量和总带宽。而实际上，现在的区块链应用都比较粗糙，它视每一个用户均为全量备份节点。因此，在这种模式下，几乎不可能承载大型视频网站，而这一问题其实也困扰着几乎所有的区块链分布式应用。

#### 1.1.4 dApp的开发效率

从以上的特性可以推导出的一件事是：基于公链的移动端应用不好做。
首先是技术层面的困难。移动端计算性能和存储空间受限，对于任何 dApp 来说都难以在移动端上跑公链的全量节点。因此，如果预期 dApp 的主要应用场景是在移动端，那么会面临网络贡献量与使用量不匹配的问题。

其次是政策方面的困难。无论在任何一个国家和地区，拥有移动市场半壁江山的苹果，都遵循需要有一个应用开发者来承担应用可能带来的侵权风险的原则。这导致一些基于社区开发的开源项目，无法登陆苹果 App Store，因为事实上没有人可以为应用中的内容负责。这种冲突，有点类似于实体经济中的共享经济，共享经济瓦解了酒店集团、出租车公司的利益，同时分散了他们的责任。一旦出现事故，难以确定责任主体，也就无从谈及追责和赔偿。

其三，「不可篡改」=「无法消错」。我们早前经常听说区块链是「不可回滚」的，后来我们又听说很多区块链社区投票一致实现了「集体回滚」。区块链本质上是一种数据库技术，在当今的大部分认知中，区块链被认为是一种「先进」的数据库技术。然而事实上，区块链却是一种天生瘸腿的数据库技术。在数据库最基础的四大功能「增删改查」（CURD）中，区块链只能实现增和查两项。这在区块链的特性中被体现为「不可篡改性」，而大多数情况下这对于一项数据库技术来说并不是什么好事。在传统数据库中，管理员拥有对数据库进行任意修改的权限，这意味着数据库中的数据出现异常，管理员一个人就可以实现数据的修正。而在区块链中，并没有这个管理员，想要实现数据修正，必须所有用户同意才可以。

为进一步说明这个问题，我们假设有一个顶尖黑客通过漏洞，为自己的 QQ账号增加了 100 万Q币。腾讯技术部门的成员发现了这一问题，只要在数据库中将对应 QQ 的 Q币值改回去就可以了。
而如果此时，Q币是使用区块链存储的，那么麻烦就来了，因为这个黑客修改100万Q币的行为已经发生而且被同步到了每一个用户的手里，那么腾讯不得不发出一个公告「请求」8 亿 QQ 用户共同修改这一事实才能「回滚」。这一问题不仅仅针对数据，而且也是对于智能合约。

### 1.2 区块链技术能为企业节约信息运维的成本吗？

成本和回报的问题（TCO/ROI)： 考虑到账本存储和智能合约存储的浪费，考虑到算力的浪费和带宽的浪费， 与中心化分布式的比较， 如何降低成本，改善ROI。

#### 1.2.1 成本（TCO）

#### 1.2.2 回报（ROI）

### 1.3 区块链真的安全方面有效率吗？

#### 1.3.1 存储安全
存储内容，通过用户公钥加密，私钥解密，安全性得到一定的保证，

大家经常听到，区块链的账本是一部“加密”的账本。存储内容，通过用户公钥加密，私钥解密，安全性得到一定的保证。但这里的加密，并非普通人理解的加密。事实上，我们还经常听说区块链的另一个特性“透明可追溯”。区块链的加密，是指通过加密方式确保参与整个链条的每一个节点都不能超出规则修改，也不能伪造成别人添加信息的一种手段。而大多数的区块链，都遵循透明可追溯的原则，每一个节点都可以看到每一次交易的信息。

私密内容与分布式存储存在意义上的冲突，换个更简单的例子来说。我们都知道当我们用迅雷下载一部影片的时候，迅雷也会在下载的过程中利用一部分带宽来帮助别人下载，这是一个典型的“你帮我，我也帮他”的模型。但如果你要传输或存储的并非是一个公开文件，而是一个只有你和对方可以看的私密文件，那么第三人为什么要帮你们去“做种”呢？没有私密会带来许多问题，比如聊个天全网都知道了，写个日记也全网都知道了。在金融等很多领域，很多时候是要求实名，但是数据是隐私的。

在已有基于联盟链的应用案例中，有时候这种情况会搞得很复杂。例如，某份交易数据，某两个节点能看到，另外两个节点则不行。我们认为只要是在同一个智能合约里，应该是对等的执行机制，要么信任、要么放弃。在金融应用中，其实还是用传统手段满足“安全、隐私”需求，为区块链隔离复杂性。

#### 1.3.2 数据使用

数据使用的问题，则存在比较大的问题（虽然可以有同态加密等），包括用户隐私和监管问题。

## 2. 可能的解决之道

我们认为一个可行的方向是，与现有中心化的分布式技术相融合，改善并优化公链构造方法。而前提条件是以数据安全为第一准则。

## 3. 小结与未来展望

## 参考文献
